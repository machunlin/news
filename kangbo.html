<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<title>åº·æ³¢å‘¨æœŸ+å…¨çƒéœ¸æƒ+å·¥ä¸šé©å‘½+ç§‘å­¦å®¶å…¨æ™¯å›¾ï¼ˆæ–‡æ˜ä¹‹å…‰ç‰ˆï¼‰</title>
<script src="https://d3js.org/d3.v7.min.js"></script>
<style>
  body { font-family: "Microsoft YaHei", sans-serif; background: #f8f8f8; margin:0; padding:0;}
  #chart { background: white; margin: 10px auto; width: 98vw; height: 1400px; position: relative;}
  svg { display: block; margin: auto; background: white; box-shadow: 0 0 5px rgba(0,0,0,0.1);}
  .tooltip {
    position: absolute; background: rgba(0,0,0,0.9); color: white;
    padding: 12px; border-radius: 8px; pointer-events: none; font-size: 14px;
    max-width: 350px; z-index: 10; line-height: 1.5;
  }
  .nation-path.major { stroke-width: 12; opacity: 0.85; cursor: pointer;}
  .nation-path.minor { stroke-width: 6; opacity: 0.65; cursor: pointer;}
  .event-circle, .scientist-star, .industrial-rect, .culture-circle, .war-rect, .crisis-rect {
    cursor: pointer;
  }
  .war-rect {
    opacity: 0.7;
  }
  .crisis-rect {
    opacity: 0.8;
    rx: 5;
    ry: 5;
  }
  .legend {
    font-size: 14px; user-select:none;
    background: #fff; border: 1px solid #ccc; padding: 12px 16px; border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.2);
    position: fixed; top: 10px; left: 50%; transform: translateX(-50%);
    display: flex; gap: 16px; flex-wrap: wrap; justify-content: center; z-index: 20;
    max-width: 92%;
  }
  .legend-item {
    cursor: pointer; display: flex; align-items: center; gap: 8px;
    white-space: nowrap;
  }
  .legend-color {
    width: 20px; height: 20px; border-radius: 4px;
    border: 1px solid #999;
  }
  .legend-item.disabled .legend-color {
    opacity: 0.3;
  }
  .legend-color.major { border-width: 2px; }
  text.axis-label {
    font-size: 14px; fill: #333;
  }
  h2 {
    text-align:center; margin:10px 0; padding-top: 80px;
    font-size: 24px; color: #333;
  }
  .civilization-path {
    stroke-width: 8; opacity: 0.7; cursor: pointer;
    stroke-dasharray: 5,5;
  }
  .wave-label {
    font-size: 14px; font-weight: bold;
  }
  .kondratiev-wave {
    stroke-width: 2.5;
    stroke-dasharray: 6,6;
    fill: none;
  }
  .industrial-label {
    font-size: 14px; font-weight: bold;
    text-anchor: middle;
  }
  .industrial-detail {
    font-size: 12px;
    text-anchor: middle;
  }
  .scientist-star {
    opacity: 0.9;
  }
  .industrial-line {
    stroke: blue;
    stroke-dasharray: 4,4;
    opacity: 0.7;
    stroke-width: 2;
  }
  .industrial-bg {
    opacity: 0.1;
  }
  /* è¯´æ˜åŒºæ ·å¼ï¼ˆä¼˜åŒ– UIï¼‰ */
  #explanation{
    background: linear-gradient(180deg, rgba(250,250,252,1), #fff);
    margin:24px auto 48px; padding:22px 26px; border-radius:12px; max-width:1100px;
    box-shadow:0 6px 20px rgba(0,0,0,0.06); color:#1f2937; line-height:1.6; font-size:15px;
  }
  #explanation .ex-hero{display:flex;gap:14px;align-items:flex-start}
  #explanation .ex-hero .ex-icon{font-size:34px;line-height:1}
  #explanation .ex-hero .ex-title{font-size:18px;font-weight:700;color:#0f172a;margin:0}
  #explanation .ex-hero .ex-sub{color:#374151;margin:6px 0 0}
  #explanation h4{margin:14px 0 8px;color:#0b66c2;font-size:16px}
  #explanation .ex-grid{display:grid;grid-template-columns:1fr;gap:12px}
  @media(min-width:900px){#explanation .ex-grid{grid-template-columns:1fr 1fr}}
  #explanation .callout{border-left:4px solid #e6f2ff;background:linear-gradient(90deg, rgba(240,247,255,0.6), rgba(255,255,255,0.4));padding:12px 14px;border-radius:8px}
  #explanation .callout.industrial{border-left-color:#dbeafe}
  #explanation .callout.kond{border-left-color:#bdecef}
  #explanation .callout.warning{border-left-color:#fee2e2;background:linear-gradient(90deg,#fff7f7,#fff)}
  #explanation ul.ex-list{padding-left:18px;margin:8px 0}
  #explanation .meta{color:#6b7280;font-size:13px;margin-top:8px}
  #explanation .anchor-link{display:inline-block;margin-left:8px;color:#0b66c2;text-decoration:none}
  /* å…³äºæŒ‰é’®æ ·å¼ */
  #about-btn{position:fixed;right:18px;top:74px;background:#0b66c2;color:#fff;border:none;padding:8px 12px;border-radius:8px;box-shadow:0 6px 18px rgba(11,102,194,0.18);cursor:pointer;z-index:40}
  @media(max-width:640px){#about-btn{right:12px;top:76px;padding:8px 10px;font-size:14px}}
</style>
</head>
<body>
<h2>åº·æ³¢å‘¨æœŸ + å·¥ä¸šé©å‘½ï¼ˆ1400â€“2025ï¼‰</h2>
<div class="legend" id="legend">
  <div class="legend-item legend-nations major" data-type="nation" data-key="major">
    <div class="legend-color" style="background:#5555cc; border-width: 2px;"></div>ä¸»å¯¼éœ¸æƒå›½å®¶
  </div>
  <div class="legend-item legend-nations minor" data-type="nation" data-key="minor">
    <div class="legend-color" style="background:#999999;"></div>å…¶ä»–å›½å®¶
  </div>
  <div class="legend-item legend-civilizations" data-type="civilization" data-key="civilization">
    <div class="legend-color" style="background:#aa66aa;"></div>å¤ä»£æ–‡æ˜
  </div>
  <div class="legend-item legend-events" data-type="event" data-key="war">
    <div class="legend-color" style="background:#777777;"></div>æˆ˜äº‰äº‹ä»¶
  </div>
  <div class="legend-item legend-events" data-type="event" data-key="crisis">
    <div class="legend-color" style="background:#cc0000;"></div>ç»æµå±æœº
  </div>
  <div class="legend-item legend-events" data-type="event" data-key="tech">
    <div class="legend-color" style="background:#0077cc;"></div>æŠ€æœ¯äº‹ä»¶
  </div>
  <div class="legend-item legend-events" data-type="event" data-key="culture">
    <div class="legend-color" style="background:#00aa00;"></div>æ–‡åŒ–äº‹ä»¶
  </div>
  <div class="legend-item legend-industrial" data-type="industrial" data-key="industrial">
    <div class="legend-color" style="background:#0000ff;"></div>å·¥ä¸šé©å‘½äº‹ä»¶
  </div>
  <div class="legend-item legend-scientist" data-type="scientist" data-key="scientist">
    <div class="legend-color" style="background:gold;"></div>ç§‘å­¦å®¶
  </div>
  <div class="legend-item" data-type="kondratiev" data-key="kondratiev">
    <div class="legend-color" style="background:teal; border: none;"></div>åº·æ³¢å‘¨æœŸæ›²çº¿
  </div>
</div>
<!-- é¡¶éƒ¨å…³äºæŒ‰é’® -->
<button id="about-btn" aria-label="å…³äºæœ¬å›¾" title="å…³äºæœ¬å›¾">å…³äº</button>
<div id="chart"></div>
<div class="tooltip" id="tooltip" style="opacity:0;"></div>
<script>
(function(){
  const margin = {top: 120, right: 100, bottom: 80, left: 90};
  const width = window.innerWidth*0.98 - margin.left - margin.right;
  const height = 1400 - margin.top - margin.bottom;
  const svg = d3.select("#chart").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .style("user-select", "none")
    .append("g").attr("transform", `translate(${margin.left},${margin.top})`);

  // æ—¶é—´èŒƒå›´1400-2025
  const yearStart = 1400, yearEnd = 2025;
  const xScale = d3.scaleLinear().domain([yearStart, yearEnd]).range([0, width]);
  const yScale = d3.scaleLinear().domain([-2, 12]).range([height, 0]);

  const tooltip = d3.select("#tooltip");

  // åº·æ³¢å‘¨æœŸæ•°æ®
  const kondratievWaves = [
    {start:1780,end:1840,label:"ç¬¬ä¸€åº·æ³¢å‘¨æœŸ",detail:"çººç»‡å·¥ä¸šä¸è’¸æ±½åŠ¨åŠ› (1780-1840)"},
    {start:1840,end:1890,label:"ç¬¬äºŒåº·æ³¢å‘¨æœŸ",detail:"é“è·¯ä¸é’¢é“æ—¶ä»£ (1840-1890)"},
    {start:1890,end:1940,label:"ç¬¬ä¸‰åº·æ³¢å‘¨æœŸ",detail:"ç”µåŠ›ä¸é‡å·¥ä¸š (1890-1940)"},
    {start:1940,end:1990,label:"ç¬¬å››åº·æ³¢å‘¨æœŸ",detail:"çŸ³æ²¹åŒ–å·¥ä¸æ±½è½¦ (1940-1990)"},
    {start:1990,end:2025,label:"ç¬¬äº”åº·æ³¢å‘¨æœŸ",detail:"ä¿¡æ¯æŠ€æœ¯ä¸å…¨çƒåŒ– (1990-2025)"}
  ];

  // ç”Ÿæˆåº·æ³¢å‘¨æœŸæ›²çº¿
  const waveData = [];
  kondratievWaves.forEach(w=>{
    for(let year=w.start; year<=w.end; year++){
      const cycle = Math.sin(((year - w.start)/(w.end - w.start))*Math.PI);
      waveData.push({year: year, value: cycle*1.5});
    }
  });
  
  // ç»˜åˆ¶åº·æ³¢å‘¨æœŸæ›²çº¿
  const wavePath = svg.append("path")
    .datum(waveData)
    .attr("class", "kondratiev-wave")
    .attr("stroke", "teal")
    .attr("d", d3.line()
      .x(d=>xScale(d.year))
      .y(d=>yScale(d.value))
    )
    .on("mouseover", (event)=>{
      tooltip.style("opacity", 1).html(`
        <strong>åº·æ³¢å‘¨æœŸæ›²çº¿</strong><br>
        é•¿æœŸç»æµå‘¨æœŸç†è®ºï¼Œçº¦40-60å¹´ä¸ºä¸€ä¸ªå‘¨æœŸ<br>
        åŒ…å«æŠ€æœ¯åˆ›æ–°ã€ç»æµæ‰©å¼ å’Œè¡°é€€é˜¶æ®µ
      `)
        .style("left", (event.pageX + 15) + "px").style("top", (event.pageY - 48) + "px");
    })
    .on("mouseout", ()=>tooltip.style("opacity", 0));

  // ä¸ºæ¯ä¸ªåº·æ³¢å‘¨æœŸæ·»åŠ æ ‡ç­¾å’Œäº¤äº’
  kondratievWaves.forEach((wave, i) => {
    const midX = xScale((wave.start + wave.end)/2);
    const yPos = yScale(1.5 + Math.sin(i * 0.5) * 0.3);
    
    const waveGroup = svg.append("g")
      .attr("class", "wave-group")
      .attr("cursor", "pointer");
    
    waveGroup.append("text")
      .attr("x", midX)
      .attr("y", yPos)
      .attr("class", "wave-label")
      .attr("text-anchor", "middle")
      .attr("fill", "teal")
      .text(wave.label)
      .on("mouseover", (event)=>{
        tooltip.style("opacity", 1).html(`
          <strong>${wave.label}</strong><br>
          æ—¶é—´: ${wave.start}-${wave.end}<br>
          ${wave.detail}
        `)
          .style("left", (event.pageX + 15) + "px").style("top", (event.pageY - 48) + "px");
      })
      .on("mouseout", ()=>tooltip.style("opacity", 0));
  });

  // å·¥ä¸šé©å‘½é˜¶æ®µï¼ˆä¼˜åŒ–æ˜¾ç¤ºï¼‰
  const industrialRevolutions = [
    {start:1760,end:1840,label:"ç¬¬ä¸€æ¬¡å·¥ä¸šé©å‘½",detail:"è’¸æ±½æœº/çººç»‡æœºæ¢°åŒ–",yPos:60,color:"rgba(0,0,255,0.1)"},
    {start:1870,end:1914,label:"ç¬¬äºŒæ¬¡å·¥ä¸šé©å‘½",detail:"ç”µåŠ›/å†…ç‡ƒæœº/å¤§è§„æ¨¡ç”Ÿäº§",yPos:90,color:"rgba(0,100,255,0.1)"},
    {start:1945,end:1990,label:"ç¬¬ä¸‰æ¬¡å·¥ä¸šé©å‘½",detail:"è®¡ç®—æœº/è‡ªåŠ¨åŒ–/æ ¸èƒ½",yPos:120,color:"rgba(0,150,255,0.1)"},
    {start:1990,end:2025,label:"ç¬¬å››æ¬¡å·¥ä¸šé©å‘½",detail:"æ•°å­—æŠ€æœ¯/äº’è”ç½‘/äººå·¥æ™ºèƒ½",yPos:150,color:"rgba(0,200,255,0.1)"}
  ];
  
  // ç»˜åˆ¶å·¥ä¸šé©å‘½èƒŒæ™¯åŒºåŸŸ
  industrialRevolutions.forEach((rev) => {
    svg.append("rect")
      .attr("class", "industrial-bg")
      .attr("x", xScale(rev.start))
      .attr("y", 0)
      .attr("width", xScale(rev.end)-xScale(rev.start))
      .attr("height", height)
      .attr("fill", rev.color);
  });
  
  // ç»˜åˆ¶å·¥ä¸šé©å‘½åŒºåŸŸå’Œæ ‡ç­¾
  industrialRevolutions.forEach((rev) => {
    const midX = xScale((rev.start + rev.end)/2);
    
    // ç»˜åˆ¶è¾¹ç•Œçº¿ï¼ˆæ›´æ˜æ˜¾çš„ç«–çº¿ï¼‰
    svg.append("line")
      .attr("class", "industrial-line")
      .attr("x1", xScale(rev.start))
      .attr("y1", 0)
      .attr("x2", xScale(rev.start))
      .attr("y2", height);
    
    svg.append("line")
      .attr("class", "industrial-line")
      .attr("x1", xScale(rev.end))
      .attr("y1", 0)
      .attr("x2", xScale(rev.end))
      .attr("y2", height);
    
    // æ·»åŠ ä¸»æ ‡ç­¾
    svg.append("text")
      .attr("x", midX)
      .attr("y", rev.yPos)
      .attr("class", "industrial-label")
      .attr("fill", "blue")
      .text(`${rev.label} (${rev.start}-${rev.end})`);
    
    // æ·»åŠ è¯¦ç»†è¯´æ˜
    svg.append("text")
      .attr("x", midX)
      .attr("y", rev.yPos + 18)
      .attr("class", "industrial-detail")
      .attr("fill", "blue")
      .text(rev.detail);
  });

  // ç²¾ç¡®è°ƒæ•´çš„å¤ä»£æ–‡æ˜æ•°æ®ï¼ˆæ·»åŠ æ¸…æœï¼‰
  const ancientCivilizations = [
    {name:"æ˜æœ",startYear:1368,peakYear:1420,endYear:1644,color:"#aa66aa",yBase:9.5,major:true},
    {name:"æ¸…æœ",startYear:1636,peakYear:1760,endYear:1912,color:"#cc6666",yBase:9.2,major:true},
    {name:"å¥¥æ–¯æ›¼å¸å›½",startYear:1299,peakYear:1550,endYear:1922,color:"#8a4c8a",yBase:9,major:false},
    {name:"è¥¿ç­ç‰™å¸å›½",startYear:1469,peakYear:1580,endYear:1715,color:"#996633",yBase:8.5,major:true},
    {name:"è«å§å„¿å¸å›½",startYear:1526,peakYear:1650,endYear:1857,color:"#aa88aa",yBase:8,major:false}
  ];

  // ç»˜åˆ¶å¤ä»£æ–‡æ˜æ›²çº¿
  function drawCivilizations(selected) {
    svg.selectAll(".civilization-path").remove();
    selected.forEach(c=>{
      const path = d3.path();
      const startX = xScale(c.startYear), peakX = xScale(c.peakYear), endX = xScale(c.endYear);
      const yBase = yScale(c.yBase);
      path.moveTo(startX, yBase + 15);
      path.bezierCurveTo((startX+peakX)/2, yBase-40, (peakX+endX)/2, yBase-40, endX, yBase+15);
      svg.append("path")
        .attr("class", "civilization-path")
        .attr("stroke", c.color)
        .attr("fill", "none")
        .attr("d", path.toString())
        .on("mouseover", (event)=>{
          tooltip.style("opacity", 1).html(`
            <strong>${c.name}</strong><br>
            å…´èµ·: ${c.startYear} (${c.major?"ä¸»è¦éœ¸æƒå›½å®¶":"åŒºåŸŸæ€§å¤§å›½"})<br>
            å·…å³°: ${c.peakYear}<br>
            è¡°è½: ${c.endYear}<br>
            ${getCivilizationDetail(c.name)}
          `)
            .style("left", (event.pageX + 15) + "px").style("top", (event.pageY - 48) + "px");
          d3.select(event.currentTarget).attr("stroke-width", 12).style("opacity", 1);
        })
        .on("mouseout", (event)=>{
          tooltip.style("opacity", 0);
          d3.select(event.currentTarget).attr("stroke-width", 8).style("opacity", 0.7);
        });
    });
  }
  
  // æ–‡æ˜è¯¦ç»†ä¿¡æ¯ï¼ˆæ·»åŠ æ¸…æœï¼‰
  function getCivilizationDetail(name) {
    const details = {
      "æ˜æœ": "æ˜æœ(1368-1644)æ˜¯ä¸­å›½å†å²ä¸Šæœ€åä¸€ä¸ªç”±æ±‰æ—å»ºç«‹çš„å¤§ä¸€ç»Ÿç‹æœï¼Œæ°¸ä¹å¹´é—´è¾¾åˆ°é¼ç››ï¼Œéƒ‘å’Œä¸‹è¥¿æ´‹å±•ç¤ºäº†å¼ºå¤§çš„æµ·ä¸ŠåŠ›é‡ã€‚",
      "æ¸…æœ": "æ¸…æœ(1636-1912)æ˜¯ä¸­å›½æœ€åä¸€ä¸ªå°å»ºç‹æœï¼Œåº·ä¹¾ç››ä¸–è¾¾åˆ°é¼ç››ï¼Œé¢†åœŸè¾¾åˆ°æœ€å¤§ï¼Œä½†åæœŸé—­å…³é”å›½å¯¼è‡´è½åäºè¥¿æ–¹å·¥ä¸šé©å‘½ã€‚",
      "å¥¥æ–¯æ›¼å¸å›½": "å¥¥æ–¯æ›¼å¸å›½(1299-1922)æ˜¯æ¨ªè·¨äºšæ¬§éä¸‰å¤§æ´²çš„å¸å›½ï¼Œè‹è±æ›¼å¤§å¸æ—¶æœŸ(1520-1566)è¾¾åˆ°é¼ç››ï¼Œæ§åˆ¶äº†ä¸œè¥¿æ–¹è´¸æ˜“è¦é“ã€‚",
      "è¥¿ç­ç‰™å¸å›½": "è¥¿ç­ç‰™å¸å›½(1469-1715)é€šè¿‡å“¥ä¼¦å¸ƒå‘ç°ç¾æ´²å’Œæ®–æ°‘æ‰©å¼ æˆä¸ºç¬¬ä¸€ä¸ªå…¨çƒæ€§å¸å›½ï¼Œ1580å¹´ä»£è¾¾åˆ°é¡¶å³°ï¼Œæ‹¥æœ‰æ— æ•Œèˆ°é˜Ÿã€‚",
      "è«å§å„¿å¸å›½": "è«å§å„¿å¸å›½(1526-1857)ç»Ÿæ²»å—äºšæ¬¡å¤§é™†ï¼Œé˜¿å…‹å·´å¤§å¸å’Œæ²™è´¾æ±—æ—¶æœŸè¾¾åˆ°é¼ç››ï¼Œå»ºé€ äº†æ³°å§¬é™µç­‰ä¼Ÿå¤§å»ºç­‘ã€‚"
    };
    return details[name] || "";
  }
  
  drawCivilizations(ancientCivilizations);

  // ç²¾ç¡®è°ƒæ•´çš„å›½å®¶å…´è¡°æ•°æ®
  const nations = [
    {name:"è‘¡è„ç‰™",startYear:1415,peakYear:1540,endYear:1580,color:"#009933",yBase:7.5,major:true},
    {name:"è·å…°",startYear:1581,peakYear:1650,endYear:1720,color:"#ff9900",yBase:7,major:true},
    {name:"æ³•å›½",startYear:1643,peakYear:1789,endYear:1815,color:"#6666ff",yBase:6.5,major:true},
    {name:"è‹±å›½",startYear:1707,peakYear:1850,endYear:1945,color:"#0033cc",yBase:6,major:true},
    {name:"ç¾å›½",startYear:1898,peakYear:1945,endYear:2025,color:"#cc0000",yBase:5.5,major:true},
    {name:"è‹è”",startYear:1922,peakYear:1955,endYear:1991,color:"#990000",yBase:5,major:false},
    {name:"ä¸­å›½",startYear:1949,peakYear:2020,endYear:2050,color:"#ff0000",yBase:4.5,major:true}
  ];

  // ç”»å›½å®¶æ›²çº¿å‡½æ•°
  function drawNations(selected){
    svg.selectAll(".nation-path").remove();
    selected.forEach(n=>{
      const path = d3.path();
      const startX = xScale(n.startYear), peakX = xScale(n.peakYear), endX = xScale(n.endYear);
      const yBase = yScale(n.yBase);
      path.moveTo(startX, yBase + 15);
      path.bezierCurveTo((startX+peakX)/2, yBase-40, (peakX+endX)/2, yBase-40, endX, yBase+15);
      svg.append("path")
        .attr("class", "nation-path " + (n.major ? "major" : "minor"))
        .attr("stroke", n.color)
        .attr("fill", "none")
        .attr("d", path.toString())
        .on("mouseover", (event)=>{
          tooltip.style("opacity", 1).html(`
            <strong>${n.name}</strong><br>
            å…´èµ·: ${n.startYear} (${n.major?"å…¨çƒä¸»å¯¼å›½å®¶":"åŒºåŸŸæ€§å¤§å›½"})<br>
            å·…å³°: ${n.peakYear}<br>
            è¡°è½: ${n.endYear}<br>
            ${getNationDetail(n.name)}
          `)
            .style("left", (event.pageX + 15) + "px").style("top", (event.pageY - 48) + "px");
          d3.select(event.currentTarget).attr("stroke-width", n.major ? 18 : 10).style("opacity", 1);
        })
        .on("mouseout", (event)=>{
          tooltip.style("opacity", 0);
          d3.select(event.currentTarget).attr("stroke-width", n.major ? 12 : 6).style("opacity", n.major ? 0.85 : 0.65);
        });
    });
  }
  
  // å›½å®¶è¯¦ç»†ä¿¡æ¯
  function getNationDetail(name) {
    const details = {
      "è‘¡è„ç‰™": "è‘¡è„ç‰™(1415-1580)é€šè¿‡èˆªæµ·æ¢ç´¢å»ºç«‹ç¬¬ä¸€ä¸ªå…¨çƒæ®–æ°‘å¸å›½ï¼Œ1494å¹´ä¸è¥¿ç­ç‰™ç­¾è®¢ã€Šæ‰˜å°”å¾·è¥¿é‡Œäºšæ–¯æ¡çº¦ã€‹ç“œåˆ†ä¸–ç•Œã€‚",
      "è·å…°": "è·å…°(1581-1720)å»ºç«‹ä¸œå°åº¦å…¬å¸ï¼Œ17ä¸–çºªæˆä¸ºæµ·ä¸Šé©¬è½¦å¤«ï¼Œé˜¿å§†æ–¯ç‰¹ä¸¹æˆä¸ºä¸–ç•Œé‡‘èä¸­å¿ƒã€‚",
      "æ³•å›½": "æ³•å›½(1643-1815)åœ¨è·¯æ˜“åå››å’Œæ‹¿ç ´ä»‘æ—¶æœŸè¾¾åˆ°é¼ç››ï¼Œæ¬§æ´²å¤§é™†éœ¸æƒï¼Œä¼ æ’­å¯è’™æ€æƒ³å’Œé©å‘½ç†å¿µã€‚",
      "è‹±å›½": "è‹±å›½(1707-1945)é€šè¿‡å·¥ä¸šé©å‘½å’Œæµ·å†›ä¼˜åŠ¿å»ºç«‹æ—¥ä¸è½å¸å›½ï¼Œ19ä¸–çºªæˆä¸ºä¸–ç•Œå·¥å‚å’Œé‡‘èä¸­å¿ƒã€‚",
      "ç¾å›½": "ç¾å›½(1898-ä»Š)é€šè¿‡ä¸¤æ¬¡ä¸–ç•Œå¤§æˆ˜å´›èµ·ä¸ºè¶…çº§å¤§å›½ï¼Œå†·æˆ˜èƒœåˆ©åæˆä¸ºå”¯ä¸€è¶…çº§å¤§å›½ï¼Œä¸»å¯¼å…¨çƒç»æµä½“ç³»ã€‚",
      "è‹è”": "è‹è”(1922-1991)äºŒæˆ˜åæˆä¸ºä¸ç¾å›½æŠ—è¡¡çš„è¶…çº§å¤§å›½ï¼Œåœ¨èˆªå¤©å’Œå†›äº‹é¢†åŸŸå–å¾—é‡å¤§æˆå°±ï¼Œ1991å¹´è§£ä½“ã€‚",
      "ä¸­å›½": "ä¸­å›½(1949-ä»Š)æ”¹é©å¼€æ”¾åç»æµå¿«é€Ÿå‘å±•ï¼Œ21ä¸–çºªæˆä¸ºä¸–ç•Œç¬¬äºŒå¤§ç»æµä½“ï¼Œå…¨çƒåˆ¶é€ ä¸šä¸­å¿ƒã€‚"
    };
    return details[name] || "";
  }
  
  drawNations(nations);

  // æˆ˜äº‰äº‹ä»¶ï¼ˆç°è‰²é•¿æ–¹å½¢ï¼‰
  const wars = [
    {name:"ç™¾å¹´æˆ˜äº‰",start:1337,end:1453,importance:4,yLevel:0,detail:"è‹±æ³•ä¹‹é—´çš„é•¿æœŸæˆ˜äº‰ï¼Œä¿ƒè¿›äº†æ°‘æ—å›½å®¶å½¢æˆ"},
    {name:"ä¸‰åå¹´æˆ˜äº‰",start:1618,end:1648,importance:4,yLevel:0,detail:"æ¬§æ´²å®—æ•™æˆ˜äº‰ï¼Œå¨æ–¯ç‰¹ä¼åˆ©äºšä½“ç³»ç¡®ç«‹"},
    {name:"ä¸ƒå¹´æˆ˜äº‰",start:1756,end:1763,importance:5,yLevel:0,detail:"ç¬¬ä¸€æ¬¡å…¨çƒæ€§æˆ˜äº‰ï¼Œè‹±å›½æˆä¸ºæœ€å¤§èµ¢å®¶"},
    {name:"æ‹¿ç ´ä»‘æˆ˜äº‰",start:1803,end:1815,importance:5,yLevel:0,detail:"æ³•å›½ä¸åæ³•åŒç›Ÿæˆ˜äº‰ï¼Œç»´ä¹Ÿçº³ä½“ç³»å»ºç«‹"},
    {name:"ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ˜",start:1914,end:1918,importance:5,yLevel:0,detail:"åŒç›Ÿå›½ä¸åçº¦å›½æˆ˜äº‰ï¼Œå‡¡å°”èµ›ä½“ç³»å½¢æˆ"},
    {name:"ç¬¬äºŒæ¬¡ä¸–ç•Œå¤§æˆ˜",start:1939,end:1945,importance:5,yLevel:0,detail:"è½´å¿ƒå›½ä¸åŒç›Ÿå›½æˆ˜äº‰ï¼Œè”åˆå›½å»ºç«‹"},
    {name:"å†·æˆ˜",start:1947,end:1991,importance:5,yLevel:0,detail:"ç¾è‹ä¸¤å¤§é˜µè¥å¯¹æŠ—ï¼Œæ ¸å¨æ…‘å¹³è¡¡"},
    {name:"é¸¦ç‰‡æˆ˜äº‰",start:1840,end:1842,importance:4,yLevel:0,detail:"ä¸­å›½ä¸è‹±å›½çš„æˆ˜äº‰ï¼Œä¸­å›½æˆ˜è´¥ï¼Œå¼€å§‹åŠæ®–æ°‘åœ°åŒ–"},
    {name:"ç”²åˆæˆ˜äº‰",start:1894,end:1895,importance:4,yLevel:0,detail:"ä¸­æ—¥æˆ˜äº‰ï¼Œä¸­å›½æˆ˜è´¥ï¼Œç­¾è®¢ã€Šé©¬å…³æ¡çº¦ã€‹"}
  ];

  // ç»˜åˆ¶æˆ˜äº‰çŸ©å½¢
  svg.selectAll(".war-rect")
    .data(wars)
    .enter().append("rect")
    .attr("class", "war-rect")
    .attr("x", d=>xScale(d.start))
    .attr("y", d=>yScale(0.5 + d.yLevel) - (d.importance * 6))
    .attr("width", d=>xScale(d.end)-xScale(d.start))
    .attr("height", d=>d.importance * 6)
    .attr("fill", "#777777")
    .on("mouseover", (event,d)=>{
      tooltip.style("opacity", 1).html(`
        <strong>${d.name} (${d.start}-${d.end})</strong><br>
        æŒç»­æ—¶é—´: ${d.end-d.start}å¹´<br>
        é‡è¦æ€§: ${"â˜…".repeat(d.importance)}<br>
        ${d.detail}
      `)
        .style("left", (event.pageX + 15) + "px").style("top", (event.pageY - 48) + "px");
      d3.select(event.currentTarget).attr("opacity", 1);
    })
    .on("mouseout", (event)=>{
      tooltip.style("opacity", 0);
      d3.select(event.currentTarget).attr("opacity", 0.7);
    });

  // ç»æµå±æœºï¼ˆçº¢è‰²åœ†è§’é•¿æ–¹å½¢ï¼‰
  const crises = [
    {name:"éƒé‡‘é¦™ç‹‚çƒ­",start:1636,end:1637,importance:3,yLevel:1,detail:"å†å²ä¸Šç¬¬ä¸€æ¬¡æœ‰è®°è½½çš„é‡‘èæ³¡æ²«ï¼Œè·å…°éƒé‡‘é¦™ä»·æ ¼æš´è·Œ"},
    {name:"å—æµ·æ³¡æ²«",start:1720,end:1720,importance:4,yLevel:1,detail:"è‹±å›½å—æµ·å…¬å¸è‚¡ç¥¨æŠ•æœºæ³¡æ²«ç ´è£‚ï¼Œå¯¼è‡´ç»æµè¡°é€€"},
    {name:"1837å¹´ææ…Œ",start:1837,end:1843,importance:4,yLevel:1,detail:"ç¾å›½é“¶è¡Œå±æœºï¼ŒæŒç»­å¤šå¹´çš„ç»æµè§æ¡"},
    {name:"é•¿æœŸè§æ¡",start:1873,end:1896,importance:5,yLevel:1,detail:"å…¨çƒæ€§ç»æµå±æœºï¼Œé€šè´§ç´§ç¼©æŒç»­20ä½™å¹´"},
    {name:"å¤§è§æ¡",start:1929,end:1939,importance:5,yLevel:1,detail:"åå°”è¡—è‚¡ç¾å¼•å‘å…¨çƒç»æµè¡°é€€ï¼Œå¤±ä¸šç‡é£™å‡"},
    {name:"çŸ³æ²¹å±æœº",start:1973,end:1975,importance:4,yLevel:1,detail:"çŸ³æ²¹ç¦è¿å¯¼è‡´èƒ½æºå±æœºå’Œå…¨çƒç»æµæ»èƒ€"},
    {name:"äºšæ´²é‡‘èå±æœº",start:1997,end:1998,importance:4,yLevel:1,detail:"äºšæ´²å¤šå›½è´§å¸è´¬å€¼ï¼Œç»æµä¸¥é‡è¡°é€€"},
    {name:"å…¨çƒé‡‘èå±æœº",start:2007,end:2009,importance:5,yLevel:1,detail:"æ¬¡è´·å±æœºå¼•å‘å…¨çƒé‡‘èä½“ç³»éœ‡è¡"},
    {name:"ç™½é“¶å±æœº",start:1630,end:1640,importance:3,yLevel:1,detail:"æ˜æœå› ç™½é“¶æµå…¥å‡å°‘å¯¼è‡´ç»æµè¡°é€€"}
  ];

  // ç»˜åˆ¶ç»æµå±æœºçŸ©å½¢
  svg.selectAll(".crisis-rect")
    .data(crises)
    .enter().append("rect")
    .attr("class", "crisis-rect")
    .attr("x", d=>xScale(d.start))
    .attr("y", d=>yScale(1.5 + d.yLevel) - (d.importance * 5))
    .attr("width", d=>xScale(d.end)-xScale(d.start))
    .attr("height", d=>d.importance * 5)
    .attr("fill", "#cc0000")
    .on("mouseover", (event,d)=>{
      tooltip.style("opacity", 1).html(`
        <strong>${d.name} (${d.start}-${d.end})</strong><br>
        æŒç»­æ—¶é—´: ${d.end-d.start}å¹´<br>
        ä¸¥é‡ç¨‹åº¦: ${"â˜…".repeat(d.importance)}<br>
        ${d.detail}
      `)
        .style("left", (event.pageX + 15) + "px").style("top", (event.pageY - 48) + "px");
      d3.select(event.currentTarget).attr("opacity", 1);
    })
    .on("mouseout", (event)=>{
      tooltip.style("opacity", 0);
      d3.select(event.currentTarget).attr("opacity", 0.8);
    });

  // æŠ€æœ¯äº‹ä»¶ï¼ˆä¼˜åŒ–å»é‡ç‰ˆï¼Œæ·»åŠ ä¸­å›½ç›¸å…³æŠ€æœ¯ï¼‰
  const techEvents = [
    {year:1440,name:"å¤è…¾å ¡å°åˆ·æœº",detail:"æ¬§æ´²å°åˆ·é©å‘½å¼€å§‹ï¼ŒçŸ¥è¯†ä¼ æ’­åŠ é€Ÿ",importance:5,yLevel:2,type:"tech"},
    {year:1608,name:"æœ›è¿œé•œå‘æ˜",detail:"ä¼½åˆ©ç•¥æ”¹è¿›æœ›è¿œé•œï¼Œå¼€å¯å¤©æ–‡è§‚æµ‹æ–°æ—¶ä»£",importance:4,yLevel:2,type:"tech"},
    {year:1765,name:"è’¸æ±½æœºæ”¹è¿›",detail:"ç“¦ç‰¹æ”¹è‰¯è’¸æ±½æœºï¼Œå·¥ä¸šé©å‘½æ ¸å¿ƒåŠ¨åŠ›",importance:5,yLevel:2,type:"tech"},
    {year:1837,name:"ç”µæŠ¥å‘æ˜",detail:"è«å°”æ–¯å‘æ˜å®ç”¨ç”µæŠ¥ç³»ç»Ÿï¼Œæ”¹å˜è¿œè·ç¦»é€šä¿¡",importance:4,yLevel:2,type:"tech"},
    {year:1876,name:"ç”µè¯å‘æ˜",detail:"è´å°”è·å¾—ç”µè¯ä¸“åˆ©ï¼Œå¼€å¯è¯­éŸ³é€šä¿¡æ—¶ä»£",importance:4,yLevel:2,type:"tech"},
    {year:1903,name:"é£æœºå‘æ˜",detail:"è±ç‰¹å…„å¼Ÿé¦–æ¬¡åŠ¨åŠ›é£è¡Œï¼Œå¼€å¯èˆªç©ºæ—¶ä»£",importance:5,yLevel:2,type:"tech"},
    {year:1947,name:"æ™¶ä½“ç®¡å‘æ˜",detail:"è´å°”å®éªŒå®¤å‘æ˜æ™¶ä½“ç®¡ï¼Œç”µå­é©å‘½å¼€ç«¯",importance:5,yLevel:2,type:"tech"},
    {year:1969,name:"äº’è”ç½‘è¯ç”Ÿ",detail:"ARPANETå»ºç«‹ï¼Œè®¡ç®—æœºç½‘ç»œæ—¶ä»£å¼€å§‹",importance:5,yLevel:2,type:"tech"},
    {year:2007,name:"æ™ºèƒ½æ‰‹æœºé©å‘½",detail:"iPhoneå‘å¸ƒï¼Œç§»åŠ¨äº’è”ç½‘æ™®åŠ",importance:4,yLevel:2,type:"tech"},
    {year:2003,name:"ç¥èˆŸäº”å·",detail:"ä¸­å›½é¦–æ¬¡è½½äººèˆªå¤©é£è¡Œï¼Œæ¨åˆ©ä¼Ÿæˆä¸ºé¦–ä½ä¸­å›½èˆªå¤©å‘˜",importance:4,yLevel:2,type:"tech"},
    {year:2016,name:"é‡å­å«æ˜Ÿ",detail:"ä¸­å›½å‘å°„ä¸–ç•Œé¦–é¢—é‡å­ç§‘å­¦å®éªŒå«æ˜Ÿ'å¢¨å­å·'",importance:4,yLevel:2,type:"tech"},
    {year:2020,name:"åŒ—æ–—ç³»ç»Ÿ",detail:"ä¸­å›½åŒ—æ–—ä¸‰å·å…¨çƒå«æ˜Ÿå¯¼èˆªç³»ç»Ÿå…¨é¢å»ºæˆ",importance:4,yLevel:2,type:"tech"}
  ];
  
  // ç»˜åˆ¶æŠ€æœ¯äº‹ä»¶
  svg.selectAll(".tech-circle")
    .data(techEvents)
    .enter().append("circle")
    .attr("class", "event-circle event-tech")
    .attr("cx", d=>xScale(d.year))
    .attr("cy", d=>yScale(2 + d.yLevel))
    .attr("r", d=>3 + d.importance)
    .attr("fill", "#0077cc")
    .on("mouseover", (event,d)=>{
      tooltip.style("opacity", 1).html(`
        <strong>${d.name} (${d.year})</strong><br>
        é‡è¦æ€§: ${"â˜…".repeat(d.importance)}<br>
        ${d.detail}
      `)
        .style("left", (event.pageX + 15) + "px").style("top", (event.pageY - 48) + "px");
    })
    .on("mouseout", ()=>tooltip.style("opacity", 0));

  // æ–‡åŒ–/æ”¿æ²»äº‹ä»¶ï¼ˆä¼˜åŒ–ç‰ˆï¼Œæ·»åŠ ä¸­å›½ç›¸å…³äº‹ä»¶ï¼‰
  const cultureEvents = [
    {year:1453,name:"å›å£«å¦ä¸å ¡é™·è½",detail:"æ‹œå åº­å¸å›½ç­äº¡ï¼Œå¥¥æ–¯æ›¼å¸å›½å´›èµ·ï¼Œæ¬§æ´²æ–‡è‰ºå¤å…´åŠ é€Ÿ",importance:4,yLevel:3,type:"culture"},
    {year:1492,name:"å“¥ä¼¦å¸ƒå‘ç°ç¾æ´²",detail:"å¼€å¯å¤§èˆªæµ·æ—¶ä»£å’Œå…¨çƒæ®–æ°‘æ‰©å¼ ",importance:5,yLevel:3,type:"culture"},
    {year:1517,name:"å®—æ•™æ”¹é©",detail:"é©¬ä¸Â·è·¯å¾·ã€Šä¹åäº”æ¡è®ºçº²ã€‹ï¼ŒåŸºç£æ•™åˆ†è£‚",importance:5,yLevel:3,type:"culture"},
    {year:1689,name:"å…‰è£é©å‘½",detail:"è‹±å›½ç¡®ç«‹å›ä¸»ç«‹å®ªåˆ¶ï¼Œè®®ä¼šä¸»æƒ",importance:4,yLevel:3,type:"culture"},
    {year:1776,name:"ç¾å›½ç‹¬ç«‹å®£è¨€",detail:"ç¾åˆ©åšåˆä¼—å›½æˆç«‹ï¼Œå¯è’™æ€æƒ³å®è·µ",importance:5,yLevel:3,type:"culture"},
    {year:1789,name:"æ³•å›½å¤§é©å‘½",detail:"æ¨ç¿»å›ä¸»ä¸“åˆ¶ï¼Œé¢å¸ƒäººæƒå®£è¨€",importance:5,yLevel:3,type:"culture"},
    {year:1917,name:"åæœˆé©å‘½",detail:"ä¿„å›½å»ºç«‹ç¬¬ä¸€ä¸ªç¤¾ä¼šä¸»ä¹‰å›½å®¶",importance:5,yLevel:3,type:"culture"},
    {year:1945,name:"è”åˆå›½æˆç«‹",detail:"å»ºç«‹æˆ˜åå›½é™…ç§©åºï¼Œç»´æŠ¤ä¸–ç•Œå’Œå¹³",importance:5,yLevel:3,type:"culture"},
    {year:1989,name:"å†·æˆ˜ç»“æŸ",detail:"æŸæ—å¢™å€’å¡Œï¼Œä¸¤ææ ¼å±€ç»ˆç»“",importance:5,yLevel:3,type:"culture"},
    {year:1405,name:"éƒ‘å’Œä¸‹è¥¿æ´‹",detail:"æ˜æœéƒ‘å’Œä¸ƒæ¬¡ä¸‹è¥¿æ´‹ï¼Œå±•ç¤ºä¸­å›½æµ·ä¸ŠåŠ›é‡",importance:4,yLevel:3,type:"culture"},
    {year:1911,name:"è¾›äº¥é©å‘½",detail:"æ¨ç¿»æ¸…æœç»Ÿæ²»ï¼Œå»ºç«‹ä¸­åæ°‘å›½",importance:5,yLevel:3,type:"culture"},
    {year:1949,name:"æ–°ä¸­å›½æˆç«‹",detail:"ä¸­åäººæ°‘å…±å’Œå›½æˆç«‹",importance:5,yLevel:3,type:"culture"},
    {year:1978,name:"æ”¹é©å¼€æ”¾",detail:"ä¸­å›½å¼€å§‹ç»æµæ”¹é©å’Œå¯¹å¤–å¼€æ”¾æ”¿ç­–",importance:5,yLevel:3,type:"culture"},
    {year:2001,name:"åŠ å…¥WTO",detail:"ä¸­å›½åŠ å…¥ä¸–ç•Œè´¸æ˜“ç»„ç»‡ï¼ŒåŠ é€Ÿèå…¥å…¨çƒç»æµ",importance:4,yLevel:3,type:"culture"}
  ];
  
  // ç»˜åˆ¶æ–‡åŒ–äº‹ä»¶
  svg.selectAll(".culture-circle")
    .data(cultureEvents)
    .enter().append("circle")
    .attr("class", "event-circle event-culture")
    .attr("cx", d=>xScale(d.year))
    .attr("cy", d=>yScale(3 + d.yLevel))
    .attr("r", d=>3 + d.importance)
    .attr("fill", "#00aa00")
    .on("mouseover", (event,d)=>{
      tooltip.style("opacity", 1).html(`
        <strong>${d.name} (${d.year})</strong><br>
        å½±å“åŠ›: ${"â˜…".repeat(d.importance)}<br>
        ${d.detail}
      `)
        .style("left", (event.pageX + 15) + "px").style("top", (event.pageY - 48) + "px");
    })
    .on("mouseout", ()=>tooltip.style("opacity", 0));

  // ç§‘å­¦å®¶æ•°æ®ï¼ˆä¼˜åŒ–æ˜¾ç¤ºï¼Œæ”¾åœ¨é¡µé¢åº•éƒ¨ï¼Œæ·»åŠ ä¸­å›½ç§‘å­¦å®¶ï¼‰
  const scientists = [
    // ç¬¬ä¸€åº·æ³¢å‘¨æœŸ (1780-1840)
    {name:"ç“¦ç‰¹",country:"è‹±å›½",birth:1736,death:1819,contribution:"æ”¹è‰¯è’¸æ±½æœºï¼Œå·¥ä¸šé©å‘½å…³é”®äººç‰©",wave:"ç¬¬ä¸€åº·æ³¢",influence:5,year:1785,yLevel:10},
    {name:"æ³•æ‹‰ç¬¬",country:"è‹±å›½",birth:1791,death:1867,contribution:"ç”µç£å­¦å¥ åŸºäººï¼Œå‘ç°ç”µç£æ„Ÿåº”",wave:"ç¬¬ä¸€åº·æ³¢",influence:5,year:1821,yLevel:10},
    
    // ç¬¬äºŒåº·æ³¢å‘¨æœŸ (1840-1890)
    {name:"è¾¾å°”æ–‡",country:"è‹±å›½",birth:1809,death:1882,contribution:"è¿›åŒ–è®ºï¼Œç”Ÿç‰©å­¦é©å‘½",wave:"ç¬¬äºŒåº·æ³¢",influence:5,year:1859,yLevel:10},
    {name:"é—¨æ·åˆ—å¤«",country:"ä¿„ç½—æ–¯",birth:1834,death:1907,contribution:"å…ƒç´ å‘¨æœŸè¡¨",wave:"ç¬¬äºŒåº·æ³¢",influence:4,year:1869,yLevel:10},
    {name:"éº¦å…‹æ–¯éŸ¦",country:"è‹±å›½",birth:1831,death:1879,contribution:"ç”µç£ç†è®ºç»Ÿä¸€è€…",wave:"ç¬¬äºŒåº·æ³¢",influence:5,year:1865,yLevel:10},
    
    // ç¬¬ä¸‰åº·æ³¢å‘¨æœŸ (1890-1940)
    {name:"å±…é‡Œå¤«äºº",country:"æ³¢å…°/æ³•å›½",birth:1867,death:1934,contribution:"æ”¾å°„æ€§ç ”ç©¶ï¼Œå‘ç°é•­å’Œé’‹",wave:"ç¬¬ä¸‰åº·æ³¢",influence:5,year:1898,yLevel:10},
    {name:"çˆ±å› æ–¯å¦",country:"å¾·å›½/ç¾å›½",birth:1879,death:1955,contribution:"ç›¸å¯¹è®ºï¼Œç°ä»£ç‰©ç†å­¦é©å‘½",wave:"ç¬¬ä¸‰åº·æ³¢",influence:5,year:1905,yLevel:10},
    {name:"ç»å°”",country:"ä¸¹éº¦",birth:1885,death:1962,contribution:"åŸå­ç»“æ„ç†è®º",wave:"ç¬¬ä¸‰åº·æ³¢",influence:4,year:1913,yLevel:10},
    
    // ç¬¬å››åº·æ³¢å‘¨æœŸ (1940-1990)
    {name:"å›¾çµ",country:"è‹±å›½",birth:1912,death:1954,contribution:"è®¡ç®—æœºç§‘å­¦ä¹‹çˆ¶",wave:"ç¬¬å››åº·æ³¢",influence:5,year:1936,yLevel:10},
    {name:"å†¯Â·è¯ºä¾æ›¼",country:"åŒˆç‰™åˆ©/ç¾å›½",birth:1903,death:1957,contribution:"ç°ä»£è®¡ç®—æœºæ¶æ„",wave:"ç¬¬å››åº·æ³¢",influence:5,year:1945,yLevel:10},
    {name:"è´¹æ›¼",country:"ç¾å›½",birth:1918,death:1988,contribution:"é‡å­ç”µåŠ¨åŠ›å­¦",wave:"ç¬¬å››åº·æ³¢",influence:4,year:1965,yLevel:10},
    {name:"é’±å­¦æ£®",country:"ä¸­å›½",birth:1911,death:2009,contribution:"ä¸­å›½èˆªå¤©ä¹‹çˆ¶",wave:"ç¬¬å››åº·æ³¢",influence:4,year:1956,yLevel:10},
    
    // ç¬¬äº”åº·æ³¢å‘¨æœŸ (1990-2025)
    {name:"ä¼¯çº³æ–¯-æ",country:"è‹±å›½",birth:1955,death:null,contribution:"å‘æ˜ä¸‡ç»´ç½‘",wave:"ç¬¬äº”åº·æ³¢",influence:5,year:1989,yLevel:10},
    {name:"å± å‘¦å‘¦",country:"ä¸­å›½",birth:1930,death:null,contribution:"å‘ç°é’è’¿ç´ ",wave:"ç¬¬äº”åº·æ³¢",influence:4,year:1972,yLevel:10},
    {name:"éœé‡‘",country:"è‹±å›½",birth:1942,death:2018,contribution:"é»‘æ´ç†è®ºç ”ç©¶",wave:"ç¬¬äº”åº·æ³¢",influence:4,year:1974,yLevel:10},
    {name:"è¢éš†å¹³",country:"ä¸­å›½",birth:1930,death:2021,contribution:"æ‚äº¤æ°´ç¨»ä¹‹çˆ¶",wave:"ç¬¬äº”åº·æ³¢",influence:4,year:1973,yLevel:10}
  ];
  
  const starPath = "M0,-1L0.2245,-0.3090L0.9511,-0.3090L0.3633,0.1180L0.5878,0.8090L0,0.3820L-0.5878,0.8090L-0.3633,0.1180L-0.9511,-0.3090L-0.2245,-0.3090Z";
  svg.selectAll(".scientist-star")
    .data(scientists)
    .enter().append("path")
    .attr("class","scientist-star")
    .attr("d", starPath)
    .attr("transform", d => `translate(${xScale(d.year)},${yScale(d.yLevel)}) scale(${d.influence*8/5})`) // è°ƒå¤§æ˜Ÿæ˜Ÿå°ºå¯¸
    .attr("fill", "gold")
    .on("mouseover", (event,d)=>{
      tooltip.style("opacity", 1).html(`
        <strong>${d.name} (${d.country})</strong><br>
        ${d.birth}â€“${d.death||"è‡³ä»Š"}<br>
        ä¸»è¦è´¡çŒ®: ${d.contribution}<br>
        æ´»è·ƒæ—¶æœŸ: ${d.wave}<br>
        å½±å“åŠ›: ${"â˜…".repeat(d.influence)}
      `)
        .style("left", (event.pageX + 15) + "px").style("top", (event.pageY - 48) + "px");
    })
    .on("mouseout", ()=>tooltip.style("opacity", 0));

  // è½´
  svg.append("g")
    .attr("transform", `translate(0,${height})`)
    .call(d3.axisBottom(xScale).ticks(30).tickFormat(d3.format("d")))
    .selectAll("text")
    .attr("transform", "translate(0,5) rotate(-45)")
    .style("text-anchor", "end");
  svg.append("g")
    .call(d3.axisLeft(yScale).ticks(10));

  // äº¤äº’æ§åˆ¶å›¾ä¾‹
  const legend = d3.select("#legend");
  const visibility = {
    nation_major: true,
    nation_minor: true,
    civilization: true,
    event_war: true,
    event_crisis: true,
    event_tech: true,
    event_culture: true,
    industrial: true,
    scientist: true,
    kondratiev: true
  };

  function updateVisibility(){
    // å›½å®¶æ›²çº¿
    svg.selectAll(".nation-path.major").style("display", visibility.nation_major ? null : "none");
    svg.selectAll(".nation-path.minor").style("display", visibility.nation_minor ? null : "none");
    // æ–‡æ˜æ›²çº¿
    svg.selectAll(".civilization-path").style("display", visibility.civilization ? null : "none");
    // æˆ˜äº‰çŸ©å½¢
    svg.selectAll(".war-rect").style("display", visibility.event_war ? null : "none");
    // å±æœºçŸ©å½¢
    svg.selectAll(".crisis-rect").style("display", visibility.event_crisis ? null : "none");
    // æŠ€æœ¯äº‹ä»¶
    svg.selectAll(".event-tech").style("display", visibility.event_tech ? null : "none");
    // æ–‡åŒ–äº‹ä»¶
    svg.selectAll(".event-culture").style("display", visibility.event_culture ? null : "none");
    // å·¥ä¸šé©å‘½
    svg.selectAll(".industrial-label, .industrial-detail").style("display", visibility.industrial ? null : "none");
    svg.selectAll(".industrial-line, .industrial-bg").style("display", visibility.industrial ? null : "none");
    // ç§‘å­¦å®¶
    svg.selectAll(".scientist-star").style("display", visibility.scientist ? null : "none");
    // åº·æ³¢å‘¨æœŸæ›²çº¿
    svg.selectAll(".kondratiev-wave, .wave-group").style("display", visibility.kondratiev ? null : "none");
  }

  legend.selectAll(".legend-item").on("click", function(){
    const item = d3.select(this);
    const type = item.attr("data-type");
    const key = item.attr("data-key");
    const mapKey = type + (key ? "_" + key : "");
    visibility[mapKey] = !visibility[mapKey];
    item.classed("disabled", !visibility[mapKey]);
    updateVisibility();
  });

  updateVisibility();
})();
</script>
<!-- é¡µé¢è¯´æ˜ï¼ˆé¢å‘é«˜ä¸­ç”Ÿçš„å­¦ä¹ å°æ´»åŠ¨ï¼‰ -->
<section id="explanation">
  <div id="ex-summary" style="margin-bottom:12px">
    <p style="margin:0;color:#374151;">æ‘˜è¦ï¼šåŒå­¦ä»¬ï¼Œè¿™æ˜¯ä¸€å¼ â€œæ—¶é—´å¤§åœ°å›¾â€ â€”â€” ç”¨å›¾ç”»å‡ºæŠ€æœ¯ã€æˆ˜äº‰ã€å›½å®¶å’Œç§‘å­¦å®¶å¦‚ä½•æ¨åŠ¨ä¸–ç•Œæ”¹å˜ã€‚</p>
    <a href="#" id="ex-toggle" style="color:#0b66c2;margin-left:8px;text-decoration:none">å±•å¼€ä¸ºå­¦ä¹ å°æ´»åŠ¨</a>
  </div>
  <div id="ex-full" style="display:none">
  <div class="ex-hero">
    <div class="ex-icon">ğŸš€</div>
    <div>
      <h3 class="ex-title">ä¸–ç•Œå‘¨æœŸå¾‹ä¸æœªæ¥æŠ•èµ„åœ°å›¾ï¼šé«˜ä¸­ç”Ÿç‰ˆå­¦ä¹ å°æ´»åŠ¨</h3>
      <div class="ex-sub">è¿™å¼ å›¾æŠŠå†å²å˜æˆäº†ä¸€åœºâ€œå¤§äº‹ä»¶ç§€â€ï¼šä½ ä¼šçœ‹åˆ°ä»€ä¹ˆæ—¶å€™æŠ€æœ¯çˆ†å‘ã€ä»€ä¹ˆæ—¶å€™ä¸–ç•ŒåŠ¨è¡ã€è°æ˜¯æ¨åŠ¨å˜é©çš„å…³é”®äººç‰©ã€‚</div>
    </div>
  </div>

  <div class="ex-grid" style="margin-top:14px">
    <div>
      <h4>I. â³ æ—¶é—´ä¸ç³»ç»Ÿçš„æ¡†æ¶ï¼ˆæ¨ªè½´ã€æˆ˜äº‰ä¸å±æœºï¼‰</h4>
      <div class="callout kond">
        <strong>1. ğŸ•° æ—¶é—´è½´ï¼ˆæ¨ªè½´ï¼‰</strong>
        <div class="meta">å°è¯¾å ‚ï¼šæ¨ªè½´æ˜¯æ—¶é—´ï¼Œäº‹ä»¶å¹¶ä¸æ˜¯å‡åŒ€å‘ç”Ÿâ€•â€•æœ‰äº›å¹´ä»£æŒ¤æ»¡äº†å¤§äº‹ï¼ˆä¾‹å¦‚ 1914-1945ï¼‰ï¼Œé‚£æ—¶ä¸–ç•Œåœ¨å¿«é€Ÿé‡ç»„ã€‚</div>
        <ul class="ex-list">
          <li>æ“ä½œæç¤ºï¼šæŠŠé¼ æ ‡ç§»åˆ°æ—¶é—´çº¿ä¸Šæ–¹æˆ–äº‹ä»¶ç‚¹ä¸Šï¼ˆæ‚¬åœï¼‰ï¼Œä¼šå¼¹å‡ºå°æç¤ºå‘Šè¯‰ä½ å‘ç”Ÿäº†ä»€ä¹ˆã€‚</li>
        </ul>
      </div>
      <div style="height:10px"></div>
      <div class="callout warning">
        <strong>2. âš”ï¸ æˆ˜äº‰ä¸å±æœº</strong>
        <div class="meta">è§£é‡Šä¸€ä¸‹é¢œè‰²ï¼šç°è‰²æ˜¯æˆ˜äº‰ï¼Œçº¢è‰²æ˜¯ç»æµå±æœºâ€”â€”å®ƒä»¬åƒé‡ç½®æŒ‰é’®ï¼Œä¼šè®©ä¸–ç•Œè§„åˆ™ã€èµ„æºå’Œæœºä¼šé‡æ–°æ´—ç‰Œã€‚</div>
        <ul class="ex-list">
          <li>çœ‹çœ‹äº¤äº’ï¼šæŠŠé¼ æ ‡ç§»åˆ°ç°è‰²/çº¢è‰²å—ä¸Šï¼Œä¼šæ˜¾ç¤ºè¯¥äº‹ä»¶çš„åå­—ã€æ—¶é—´å’Œä¸ºä»€ä¹ˆé‡è¦ã€‚</li>
        </ul>
      </div>
    </div>

    <div>
      <h4>II. ğŸ’¡ é©±åŠ¨å‘¨æœŸçš„æ ¸å¿ƒå¼•æ“ï¼ˆç»æµæ³¢æµªä¸å·¥ä¸šé©å‘½ï¼‰</h4>
      <div class="callout industrial">
        <strong>3. ğŸŒŠ ç»æµæ³¢æµªçº¿ï¼ˆé’è‰²ï¼‰</strong>
        <div class="meta">ç”¨æ›´ç®€å•çš„è¯è¯´ï¼šç»æµåƒæµ·æµªï¼Œæœ‰é«˜æ½®ä¹Ÿæœ‰ä½è°·ã€‚æˆ‘ä»¬ç°åœ¨åœ¨ä¿¡æ¯æŠ€æœ¯æµªå¤´çš„åæ®µï¼Œä¸‹ä¸€æ³¢æµªå¯èƒ½ç”± AIã€ç”Ÿå‘½ç§‘å­¦å’Œç»¿èƒ½æ¨åŠ¨ã€‚</div>
        <ul class="ex-list">
          <li>è¯¾å ‚å»ºè®®ï¼šè§‚å¯Ÿæ³¢å³°/æ³¢è°·çš„å¹´ä»½ï¼Œæƒ³ä¸€æƒ³é‚£æ—¶å“ªäº›æ–°æŠ€æœ¯æˆ–å…¬å¸å‡ºç°äº†ã€‚</li>
        </ul>
      </div>
      <div style="height:10px"></div>
      <div class="callout">
        <strong>4. âš™ï¸ å·¥ä¸šé©å‘½ä¸æŠ€æœ¯ç«ç§ï¼ˆè“è‰²åŒºåŸŸ + é‡‘è‰²æ˜Ÿæ˜Ÿï¼‰</strong>
        <div class="meta">å›¾ä¸­çš„è“è‰²å—æ˜¯æŠ€æœ¯æµªæ½®ï¼Œé‡‘è‰²æ˜Ÿä»£è¡¨é‡è¦ç§‘å­¦å®¶æˆ–çªç ´ï¼›è¿™äº›å¸¸å¸¸æ˜¯â€œä¸‹ä¸€è½®å˜é©â€çš„ç«ç§ã€‚</div>
        <ul class="ex-list">
          <li>è¯¾å ‚ä»»åŠ¡ï¼šæ‰¾åˆ°ä¸€ä¸ªé‡‘è‰²æ˜Ÿï¼ˆç§‘å­¦å®¶ï¼‰ï¼Œæ‚¬åœçœ‹ä»–çš„è´¡çŒ®ï¼Œæƒ³æƒ³è¿™é¡¹å‘ç°å¦‚ä½•æ”¹å˜ç”Ÿæ´»ã€‚</li>
        </ul>
      </div>
    </div>
  </div>

  <div style="margin-top:14px">
    <h4>III. ğŸ‘‘ æƒåŠ›ä¸è¶‹åŠ¿çš„äº¤ç»‡ï¼ˆå›½å®¶æ›²çº¿ä¸è”ç³»çº¿ï¼‰</h4>
    <div class="callout">
      <strong>5. ğŸ‘‘ å›½å®¶æƒåŠ›æ›²çº¿ï¼ˆå½©è‰²ï¼‰</strong>
      <div class="meta">å½©è‰²çš„å›½å®¶æ›²çº¿åƒä¸€æ¡ç”Ÿå‘½çº¿ï¼šé«˜å³°è¯´æ˜è¿™ä¸ªå›½å®¶å½“æ—¶å¾ˆå¼ºï¼ˆæŠ€æœ¯ã€å†›åŠ›æˆ–ç»æµï¼‰ï¼Œäº¤æ›¿æœŸé€šå¸¸æ˜¯å¤§å˜é©çš„æ—¶åˆ»ã€‚</div>
      <ul class="ex-list">
        <li>ç­–ç•¥å¯ç¤ºï¼šæŠŠæ¡æŠ€æœ¯æ ‡å‡†ä¸ä¾›åº”é“¾é‡æ„çš„æœºä¼šã€‚</li>
      </ul>
    </div>
    <div style="height:10px"></div>
    <div class="callout">
      <strong>6. ğŸ”— äº‹ä»¶è”ç³»çº¿</strong>
      <div class="meta">ç®€å•è¿çº¿ï¼šç§‘å­¦å®¶â†’æŠ€æœ¯äº‹ä»¶â†’ç»æµå¤§æµªã€‚é€†å‘é“¾æ¡ï¼šæ³¢è°·â†’å±æœº/æˆ˜äº‰â†’æƒåŠ›æ›´æ›¿ã€‚ç†è§£è¿™äº›è¿çº¿æœ‰åŠ©äºçœ‹æ¸…å› æœã€‚</div>
      <ul class="ex-list">
        <li>æ¶æ„æ€è€ƒï¼šé¡¹ç›®éœ€å…·å¤‡â€œéŸ§æ€§â€å¹¶èƒ½å¿«é€Ÿé€‚åº”æŠ€æœ¯èŒƒå¼è½¬ç§»ã€‚</li>
      </ul>
    </div>
  </div>

  <div style="margin-top:14px" class="callout">
    <h4>IV. å°ç»“ä¸è¯¾å ‚ä»»åŠ¡</h4>
    <p class="meta">ä¸€å¥è¯æ€»ç»“ï¼šå†å²åƒå¤§æµ·çš„æ½®æ±â€”â€”äº†è§£æ½®æ±ï¼Œä½ å°±çŸ¥é“ä»€ä¹ˆæ—¶å€™å‡ºæµ·ã€ä»€ä¹ˆæ—¶å€™ä¿®èˆ¹ã€‚</p>
    <ul class="ex-list">
      <li><strong>ç»™åŒå­¦ä»¬çš„å°ä»»åŠ¡ï¼š</strong>ç”¨ 5 åˆ†é’Ÿåœ¨å›¾ä¸Šæ‰¾å‡ºä¸€ä¸ªä½ æ„Ÿå…´è¶£çš„å¹´ä»½ï¼Œæ‚¬åœæŸ¥çœ‹è¯´æ˜ï¼Œç„¶ååœ¨è¯¾å ‚ä¸Šè¯´å‡ºä½ è®¤ä¸ºé‚£å¹´ä¸ºä»€ä¹ˆé‡è¦ã€‚</li>
      <li><strong>æ“ä½œè´´å£«ï¼š</strong>ç‚¹å‡»å›¾ä¾‹æ¥å¼€/å…³ä¸åŒå›¾å±‚ï¼ˆæ¯”å¦‚å…ˆçœ‹åªæœ‰å›½å®¶çº¿ï¼Œå†æ‰“å¼€ç§‘æŠ€äº‹ä»¶ï¼‰ï¼›ç”¨â€œå…³äºâ€æŒ‰é’®å¿«é€Ÿè·³åˆ°åº•éƒ¨è¯´æ˜å¹¶å±•å¼€å…¨æ–‡ã€‚</li>
      <li><strong>ç§»åŠ¨è®¾å¤‡ï¼š</strong>åœ¨æ‰‹æœºä¸Šå…ˆçœ‹æ‘˜è¦ï¼Œç‚¹å‡»â€œå±•å¼€ä¸ºå­¦ä¹ å°æ´»åŠ¨â€çœ‹åˆ°å®Œæ•´å†…å®¹ï¼›åŒæŒ‡ç¼©æ”¾å¯åœ¨å¤§å›¾ä¸ŠæŸ¥çœ‹ç»†èŠ‚ã€‚</li>
    </ul>
    <p class="meta" style="margin-bottom:0">å¦‚æœä½ è¦æˆ‘æŠŠè¿™äº›å˜æˆå¯æ‰“å°çš„è¯¾å ‚è®²ä¹‰æˆ–ç¼©çŸ­æˆ PPT è¦ç‚¹ï¼Œæˆ‘å¯ä»¥ç»§ç»­å¸®ä½ æ•´ç†ã€‚</p>
  </div>

  </div>
</section>
<script>
// å…³äºæŒ‰é’®ã€æŠ˜å è¯´æ˜ä¸å¹³æ»‘æ»šåŠ¨
(function(){
  const aboutBtn = document.getElementById('about-btn');
  const exSection = document.getElementById('explanation');
  const exToggle = document.getElementById('ex-toggle');
  const exFull = document.getElementById('ex-full');

  function smoothScrollTo(el){
    const offset = 20; // å°‘é‡é¡¶éƒ¨é—´è·
    const top = el.getBoundingClientRect().top + window.pageYOffset - offset;
    window.scrollTo({top, behavior:'smooth'});
  }

  aboutBtn.addEventListener('click', ()=>{
    // å±•å¼€å¹¶æ»šåŠ¨
    if(exFull.style.display === 'none') {
      exFull.style.display = 'block';
      exToggle.textContent = 'æ”¶èµ·å…¨æ–‡';
    }
    smoothScrollTo(exSection);
  });

  exToggle.addEventListener('click', (e)=>{
    e.preventDefault();
    if(exFull.style.display === 'none'){
      exFull.style.display = 'block';
      exToggle.textContent = 'æ”¶èµ·å…¨æ–‡';
    } else {
      exFull.style.display = 'none';
      exToggle.textContent = 'å±•å¼€å…¨æ–‡';
      smoothScrollTo(exSection);
    }
  });

  // ç§»åŠ¨ç«¯ï¼šå½“å±å¹•å®½åº¦å°äº 640 æ—¶ï¼Œè®© summary å¯ç‚¹å‡»ä»¥å±•å¼€
  if(window.matchMedia && window.matchMedia('(max-width:640px)').matches){
    document.getElementById('ex-summary').addEventListener('click', ()=>{
      if(exFull.style.display === 'none'){
        exFull.style.display = 'block'; exToggle.textContent='æ”¶èµ·å…¨æ–‡';
      }
    });
  }
})();
</script>
</body>
</html>


